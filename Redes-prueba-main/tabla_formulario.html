<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Tabla con Formulario</title>
<link rel="stylesheet" href="ejercicio4.css">

<style>
/* Profesor-like minimal layout (keeps your own CSS) */
body.prof-theme { font-family: Arial, sans-serif; margin:0; background: linear-gradient(#cfcfcf, #6f6f6f); }
.prof-header { background:#e9e6d0; padding:18px; text-align:center; font-weight:bold; }
.prof-container { max-width:1100px; margin:30px auto; padding:10px; }
.table-header { background:#c84b4b; color:#200; padding:12px 0; display:flex; gap:0; align-items:center; }
.table-header .col { flex:1; text-align:center; font-size:12px; font-weight:600; text-transform:uppercase; padding:6px 4px; }
.footer { text-align:center; padding:16px; margin-top:20px; background:rgba(0,0,0,0.05); }
.modal-overlay { position:fixed; inset:0; background:rgba(0,0,0,0.45); display:flex; align-items:center; justify-content:center; }
.modal-box { width:80%; max-width:1000px; background:#efe9d0; border:1px solid #bfb4a0; box-shadow:0 0 0 6px rgba(0,0,0,0.08); }
.modal-header { background:#c9c0c0; padding:12px 18px; font-weight:bold; }
.modal-body { padding:20px; display:flex; gap:30px; }
.input-box { width:100%; padding:10px; border:1px solid #9a9a9a; background:#e7e7e7; margin-bottom:12px; }
@media (max-width:800px){ .modal-body{flex-direction:column;} .table-header .col{font-size:11px;} }
</style>
</head>
<body>
<div class="prof-header">Artículos</div>
<div class="prof-container">
  <div style="display:flex; justify-content:flex-end; gap:12px; margin:10px 0;">
    <button onclick="cargarDatos()">Cargar datos</button>
    <button onclick="vaciarDatos()">Vaciar datos</button>
    <button onclick="abrirModal()">Cargar Form</button>
  </div>

  <div class="table-header" role="table">
    <div class="col">CodArt</div>
    <div class="col">Familia</div>
    <div class="col">UM</div>
    <div class="col">Descripción</div>
    <div class="col">Fecha Alta</div>
    <div class="col">Saldo Stock</div>
  </div>

  <div id="table-body" style="background:linear-gradient(#8fb0b8,#6a6a6a); min-height:320px; padding:20px; color:#111;">
    
<header><h1>Tabla con Formulario</h1></header>
<main>
<div class="controls">
<button class="btn" id="load2">Cargar</button>
<button class="ghost" id="clear2">Vaciar</button>
<button class="btn" id="open2">Abrir Formulario</button>
</div>
<div class="table-wrap">
<table id="tabla2">
<thead>
<tr>
<th>NroComprobante</th><th>NroFacturaImputada</th><th>CodigoTipo</th><th>DescripcionTipo</th><th>CodCliente</th><th>RazonSocial</th><th>FechaComprobante</th><th>TotalComprobante</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>
<div class="modal-overlay" id="overlay2">
<div class="modal-box">
<div style="display:flex;justify-content:space-between;align-items:center">
<strong>Alta Nota</strong><button id="close2" class="ghost">X</button>
</div>
<form id="form2" style="margin-top:12px">
<div class="row"><div class="col"><label>Nro</label><input id="f_nro"></div><div class="col"><label>Tipo</label><select id="f_tipo"></select></div></div>
<div class="row"><div class="col"><label>Factura</label><input id="f_fact"></div><div class="col"><label>Cliente</label><input id="f_cli"></div></div>
<div class="row"><div class="col"><label>Razon</label><input id="f_raz"></div><div class="col"><label>Fecha</label><input id="f_fecha" type="date"></div></div>
<div style="margin-top:12px;display:flex;gap:8px;justify-content:flex-end"><button class="btn" id="f_send" type="submit">Agregar</button><button class="ghost" id="f_cancel" type="button">Cancelar</button></div>
</form>
</div>
</div>
</main>
<script>
(function(){
const tbody=document.querySelector('#tabla2 tbody');
let datos=[];
document.getElementById('load2').addEventListener('click',function(){fetch('notas_debito.json').then(r=>r.json()).then(j=>{datos=j.encabezados_notas_debito||[];render()})});
document.getElementById('clear2').addEventListener('click',function(){datos=[];render()});
document.getElementById('open2').addEventListener('click',function(){fetch('notas_debito.json').then(r=>r.json()).then(j=>{const sel=document.getElementById('f_tipo');sel.innerHTML='';(j.tipos_comprobante_disponibles||[]).forEach(t=>{const o=document.createElement('option');o.value=t.codigo_tipo;o.textContent=t.codigo_tipo+' - '+t.descripcion_tipo;sel.appendChild(o)});document.getElementById('overlay2').style.display='flex'})});
document.getElementById('close2').addEventListener('click',function(){document.getElementById('overlay2').style.display='none'});
document.getElementById('f_cancel').addEventListener('click',function(){document.getElementById('overlay2').style.display='none'});
document.getElementById('form2').addEventListener('submit',function(e){e.preventDefault();const n={nro_comprobante:document.getElementById('f_nro').value,nro_de_factura_imputada:document.getElementById('f_fact').value,tipo_comprobante:{codigo_tipo:document.getElementById('f_tipo').value,descripcion_tipo:document.getElementById('f_tipo').selectedOptions[0]?.text.split(' - ')[1]},cod_cliente:document.getElementById('f_cli').value,razon_social:document.getElementById('f_raz').value,fecha_comprobante:document.getElementById('f_fecha').value,total_comprobante:0};datos.push(n);render();document.getElementById('overlay2').style.display='none';document.getElementById('form2').reset()});
function render(){tbody.innerHTML='';datos.forEach(n=>{const tr=document.createElement('tr');tr.innerHTML='<td>'+ (n.nro_comprobante||'') +'</td><td>'+ (n.nro_de_factura_imputada||'') +'</td><td>'+ (n.tipo_comprobante?.codigo_tipo||'') +'</td><td>'+ (n.tipo_comprobante?.descripcion_tipo||'') +'</td><td>'+ (n.cod_cliente||'') +'</td><td>'+ (n.razon_social||'') +'</td><td>'+ (n.fecha_comprobante||'') +'</td><td>'+ (n.total_comprobante||'') +'</td>';tbody.appendChild(tr)})}
})();
</script>

  </div>

  <div style="display:flex; justify-content:space-between; margin-top:8px;">
    <div style="font-size:12px; padding:8px;">sum codArt</div>
    <div style="font-size:12px; padding:8px;">sum familia</div>
    <div style="font-size:12px; padding:8px;">sum um</div>
    <div style="font-size:12px; padding:8px;">sum descripcion</div>
    <div style="font-size:12px; padding:8px;">sum fecha alta</div>
    <div style="font-size:12px; padding:8px;">sum saldo Stock</div>
  </div>

  <div class="footer">Pie</div>
</div>

<script>
/* small helpers to mimic previous demo behavior; these functions won't overwrite your existing ones if present */
function cargarDatos(){{ if(typeof window.cargarDatosOriginal==='function'){{ window.cargarDatosOriginal(); return; }} alert('Cargar datos demo'); }}
function vaciarDatos(){{ if(typeof window.vaciarDatosOriginal==='function'){{ window.vaciarDatosOriginal(); return; }} alert('Vaciar datos demo'); }}
function abrirModal(){{ document.getElementById('modal-overlay') && (document.getElementById('modal-overlay').style.display='flex'); }}
function renderTable(){{ /* noop here - your original scripts may take over */ }}
</script>
</body>
</html>